<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculate.me!</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="header">
      <h1>Calculate.me</h1>
      <h2>Let's calculate together!</h2>
    </div>
    <div class="calculator">
      <input class="displayOperation" type="text" />
      <input class="displayResult" type="text" />
      <div class="controlPanel">
        <div class="non-operations">
          <button class="clear_button">AC</button>
          <button>Backspace</button>
          <button class="number">1</button>
          <button class="number">2</button>
          <button class="number">3</button>
          <button class="number">4</button>
          <button class="number">5</button>
          <button class="number">6</button>
          <button class="number">7</button>
          <button class="number">8</button>
          <button class="number">9</button>
          <button>.</button>
          <button class="number">0</button>
          <button class="equality_operator">=</button>
        </div>
        <div class="operations">
          <button class="operator">+</button>
          <button class="operator">-</button>
          <button class="operator">/</button>
          <button class="operator">*</button>
        </div>
      </div>
    </div>
    <script>
      // Mathematical operations block

      let highPriorityOperators = [`/`, `*`];
      let lowPriorityOperators = [`-`, `+`];

      let add = function (num1, num2) {
        let result = parseInt(num1) + parseInt(num2);
        return result;
      };

      let subtract = function (num1, num2) {
        let result = parseInt(num1) - parseInt(num2);
        return result;
      };

      let multiply = function (num1, num2) {
        let result = parseInt(num1) * parseInt(num2);
        return result;
      };

      let divide = function (num1, num2) {
        let result = parseInt(num1) / parseInt(num2);
        return result;
      };

      let operate = function (arr) {
        if (arr.includes(`+`)) {
          return add(arr[0], arr[2]);
        } else if (arr.includes(`-`)) {
          return subtract(arr[0], arr[2]);
        } else if (arr.includes(`*`)) {
          return multiply(arr[0], arr[2]);
        } else if (arr.includes(`/`)) {
          return divide(arr[0], arr[2]);
        }
      };

      let countDivisionAndMultiply = function (arr) {
        let countOfDivision = arr.filter((item) => item == `/`).length;
        let countOfMultiply = arr.filter((item) => item == `*`).length;
        let count = countOfDivision + countOfMultiply;
        return count;
      };

      let countSumAndSubtraction = function (arr) {
        let countOfSum = arr.filter((item) => item == `+`).length;
        let countOfSubtraction = arr.filter((item) => item == `-`).length;
        let count = countOfSum + countOfSubtraction;
        return count;
      };

      // Whatever else that's required in my project block

      let clear_button = document.querySelector(".clear_button");
      clear_button.addEventListener("click", function () {
        displayOperation.value = "";
      });
      let displayOperation = document.querySelector(".displayOperation");
      let number_buttons = document.querySelectorAll(".number");
      for (let i = 0; i < 10; i++) {
        number_buttons[i].addEventListener("click", function () {
          displayOperation.value += this.textContent;
        });
      }
      let operator = document.querySelectorAll(".operator");
      for (let i = 0; i < 4; i++) {
        operator[i].addEventListener("click", function () {
          displayOperation.value += this.textContent;
        });
      }

      let operateMultipleHighPriorityOperators = function (arr) {
        for (let i = countDivisionAndMultiply(arr); i > 0; i--) {
          if (arr.includes(`/`)) {
            let indexOfOperation = arr.indexOf("/");
            let portionOfExpression = arr.splice(indexOfOperation - 1, 3);
            console.log(portionOfExpression);
            let resultOfPortion = operate(portionOfExpression);
            arr.splice(indexOfOperation - 1, 0, resultOfPortion);
            console.log(arr);
          } else if (arr.includes(`*`)) {
            let indexOfOperation = arr.indexOf("*");
            let portionOfExpression = arr.splice(indexOfOperation - 1, 3);
            console.log(portionOfExpression);
            let resultOfPortion = operate(portionOfExpression);
            arr.splice(indexOfOperation - 1, 0, resultOfPortion);
            console.log(arr);
          }
        }
      };

      let operateMultipleLowPriorityOperators = function (arr) {
        for (let i = countSumAndSubtraction(arr); i > 0; i--) {
          if (arr.includes(`+`)) {
            let indexOfOperation = arr.indexOf("+");
            let portionOfExpression = arr.splice(indexOfOperation - 1, 3);
            console.log(portionOfExpression);
            let resultOfPortion = operate(portionOfExpression);
            arr.splice(indexOfOperation - 1, 0, resultOfPortion);
            console.log(arr);
          } else if (arr.includes(`-`)) {
            let indexOfOperation = arr.indexOf("-");
            let portionOfExpression = arr.splice(indexOfOperation - 1, 3);
            console.log(portionOfExpression);
            let resultOfPortion = operate(portionOfExpression);
            arr.splice(indexOfOperation - 1, 0, resultOfPortion);
            console.log(arr);
          }
        }
      };

      let equality_operator = document.querySelector(".equality_operator");
      equality_operator.addEventListener("click", function () {
        let user_input = displayOperation.value.toString().split(/([+-/*])/);
        console.log(user_input);
        if (
          lowPriorityOperators.some((item) => user_input.includes(item)) &&
          highPriorityOperators.some((item) => user_input.includes(item))
        ) {
          operateMultipleHighPriorityOperators(user_input);
          operateMultipleLowPriorityOperators(user_input);
        } else if (
          !highPriorityOperators.some((item) => user_input.includes(item))
        ) {
          operateMultipleLowPriorityOperators(user_input);
        } else if (
          !lowPriorityOperators.some((item) => user_input.includes(item))
        ) {
          operateMultipleHighPriorityOperators(user_input);
        }
      });
    </script>
  </body>
</html>
